<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/Article">
  	<head>
  		<!-- Volta CSS Stuff -->
    	<link rel="icon" type="image/ico" href="https://d2gl3otkt8l7qr.cloudfront.net/favicon.png">
 		<link rel="stylesheet" href="https://d2gl3otkt8l7qr.cloudfront.net/assets/1.2/dist/css/volta.css">
		<!-- Okta widget stuff -->
		<script src="https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/2.16.0/js/okta-sign-in.min.js" type="text/javascript"></script>
		<link href="https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/2.16.0/css/okta-sign-in.min.css" type="text/css" rel="stylesheet"/>
		<link href="https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/2.16.0/css/okta-theme.css" type="text/css" rel="stylesheet"/>

  	</head>
	<body>
		<div id="okta-login-container"></div>	
		<!-- use the Okta widget to power authentication! -->
		<script type="text/javascript">
		  var oktaSignIn = new OktaSignIn({
		    baseUrl: "https://dev-729731.okta.com",
		    clientId: "0oawl0b18azKfOpTG356",
		    redirectUri: "https://fabianp5060.github.io",
		    authParams: {
		      issuer: "https://dev-729731.okta.com/oauth2/default",
		      responseType: ['token', 'id_token'],
		      display: 'page'
		    }
		  });

		  if (oktaSignIn.token.hasTokensInUrl()) {
		    oktaSignIn.token.parseTokensFromUrl(
		      // If we get here, the user just logged in.
		      function success(res) {
		        var accessToken = res[0];
		        var idToken = res[1]

		        oktaSignIn.tokenManager.add('accessToken', accessToken);
		        oktaSignIn.tokenManager.add('idToken', idToken);

		        window.location.hash='';
		        document.getElementById("messageBox").innerHTML = "Hello, " + idToken.claims.email + "! You just logged in! :)";
		      },
		      function error(err) {
		        console.error(err);
		      }
		    );
		  } else {
		    oktaSignIn.session.get(function (res) {
		      // If we get here, the user is already signed in.
		      if (res.status === 'ACTIVE') {
		        document.getElementById("messageBox").innerHTML = "Hello, " + res.login + "! You are *still* logged in! :)";
		        return;
		      }
		      oktaSignIn.renderEl(
		        { el: '#okta-login-container' },
		        function success(res) {},
		        function error(err) {
		          console.error(err);
		        }
		      );
		    });
		  }
		  var accessToken = oktaSignIn.tokenManager.get('accessToken');
		  var iToken = oktaSignIn.tokenManager.get('idToken');

		  console.log("my access token "+accessToken+" idToken Email: " + iToken.claims.email)

	  	  var auth_button = document.getElementById("auth_button");	
		  if (!accessToken) {
		  	console.log("Didi not find accesstoke");
		    // This means that the user is not logged in
		    window.onload = function(){
		  	  document.getElementById('demo_button').style.visibility = 'hidden';

		  	  auth_button.innerHTML = "Sign-In";
		    } 
		  } else {
		    document.getElementById('email_addr').innerHTML = iToken.claims.email;
		    auth_button.innerHTML = "Sign-Out"; 
	        auth_button.onclick = function (){
	          oktaSignIn.session.close(function (err) {
	            if (err) {
	    	      console.log("Error logging out: " + err);
	              // The user has not been logged out, perform some error handling here.
	              return;
	            } else {
	      	      console.log("User has been logged out");
	            }
	            // The user is now logged out. Render the Sign-In Widget.
	          });
            }		  	  
		  }		      
		</script>

		<script>
		  var simpleText = "hello_world";
		  var finalSplitText = simpleText.split("_");
		  var splitText = finalSplitText[0];

		  window.onload = function() {
		       //when the document is finished loading, replace everything
		       //between the <a ...> </a> tags with the value of splitText
		    document.getElementById("myLink").innerHTML=splitText; 
	      }
		  
		</script>
	</body>
</html>